# Claude Code での効果的な開発手順

## 📋 目次
1. [プロジェクト初期設定](#1-プロジェクト初期設定)
2. [開発サイクル](#2-開発サイクル)
3. [コマンドとツールの活用](#3-コマンドとツールの活用)
4. [トラブルシューティング](#4-トラブルシューティング)
5. [コラボレーション](#5-コラボレーション)

---

## 1. プロジェクト初期設定

### 1.1 CLAUDE.md の作成
プロジェクトルートに`CLAUDE.md`を作成し、プロジェクト固有の情報を記載：

```markdown
# CLAUDE.md

## プロジェクト概要
- 目的: [プロジェクトの目的]
- 技術スタック: [使用技術]
- 主要機能: [機能リスト]

## 作業ディレクトリ
- ルート: C:\myapps\[project-name]
- 開発サーバーポート: [ポート番号]

## 制約・禁止事項
- [プロジェクト固有の制約]

## 実装ルール
- [コーディング規約]
```

### 1.2 開発ガイドラインの準備
```bash
# ガイドラインドキュメントを作成
docs/
├── DEVELOPMENT_GUIDELINES_JP.md  # 開発原則
├── IMPLEMENTATION_PLAN.md        # 実装計画（都度作成）
└── TROUBLESHOOTING_LOG.md       # 問題解決ログ
```

---

## 2. 開発サイクル

### 2.1 計画フェーズ（PLAN）

#### ステップ1: 要件の明確化
```markdown
## 要件
- **目的**: 何を実現したいか
- **制約**: 守るべき条件
- **成功基準**: 完了の定義
```

#### ステップ2: 実装計画の作成
```markdown
## IMPLEMENTATION_PLAN.md

### Stage 1: 調査と準備
**目標**: 既存コードの理解
**作業**: 
- 類似機能を3つ調査
- 使用パターンの特定
**ステータス**: [未着手]

### Stage 2: テスト作成
**目標**: テストケースの準備
**作業**: 
- ユニットテスト作成
- 統合テスト作成
**ステータス**: [未着手]

### Stage 3: 実装
**目標**: 最小限の実装
**作業**: 
- 基本機能の実装
- エラー処理
**ステータス**: [未着手]
```

### 2.2 実装フェーズ（DO）

#### 効果的な指示の出し方

**良い例 ✅**
```
「ContactListコンポーネントに検索機能を追加してください。
要件：
1. リアルタイム検索（デバウンス500ms）
2. 名前、メール、電話番号で検索
3. 既存のスタイルパターンを踏襲
制約：既存のAPIエンドポイントを変更しない」
```

**悪い例 ❌**
```
「検索機能を追加して」
（具体性がない）
```

#### 段階的な実装
```bash
# 1. まず読み込みと理解
"ContactList.tsxの現在の実装を確認して、検索機能追加の計画を立ててください"

# 2. テストから始める
"検索機能のテストケースを作成してください"

# 3. 実装
"テストが通る最小限の検索機能を実装してください"

# 4. リファクタリング
"検索機能のコードをより読みやすくリファクタリングしてください"
```

### 2.3 検証フェーズ（CHECK）

#### チェックリスト
```markdown
□ コンパイルが通る
□ 既存テストが全て通る
□ 新機能のテストがある
□ ESLintエラーがない（警告は許容）
□ コミットメッセージが明確
```

#### テスト実行
```bash
# 各種テストコマンド
npm run lint        # リンター実行
npm run test        # テスト実行
npm run build       # ビルド確認
npm run dev         # 開発サーバー起動
```

### 2.4 改善フェーズ（ACT）

#### コードレビュー依頼
```
「先ほどの実装を開発ガイドラインに照らしてレビューしてください」
```

---

## 3. コマンドとツールの活用

### 3.1 TodoWriteツールの活用
```
「以下のタスクをTodoリストに追加して実行してください：
1. APIエンドポイントの調査
2. データベーススキーマの確認
3. フロントエンド実装
4. テスト作成」
```

### 3.2 並列処理の活用
```
「以下を並行して実行してください：
- ContactList.tsxを読み込む
- 関連するAPIルートを確認
- テストファイルを確認」
```

### 3.3 Agent（Task）ツールの活用
```
「ユーザー認証機能について、コードベース全体を調査してください」
（複雑な調査タスクにはAgentツールが効果的）
```

---

## 4. トラブルシューティング

### 4.1 3回ルールの実践

```markdown
## トラブルシューティングログ

### 問題: ビルドエラー
#### 試行1 (10分)
- アプローチ: 依存関係の再インストール
- 結果: 失敗
- エラー: Module not found

#### 試行2 (10分)
- アプローチ: キャッシュクリア
- 結果: 失敗
- エラー: 同じエラー

#### 試行3 (10分)
- アプローチ: tsconfig.json確認
- 結果: 失敗

### 再評価
- 根本原因: インポートパスの誤り
- 新アプローチ: 全インポート文を確認
```

### 4.2 エラー時の効果的な質問
```
「以下のエラーが発生しました：
[エラーメッセージ]

環境：
- Node.js: v20.x
- Next.js: 15.x

既に試したこと：
1. npm install
2. キャッシュクリア

他に確認すべき点を教えてください」
```

---

## 5. コラボレーション

### 5.1 Git/GitHub 連携

#### 初期設定
```bash
git init
git remote add origin [URL]
git add .
git commit -m "Initial commit"
git push -u origin main
```

#### コミットのベストプラクティス
```bash
# 小さな単位でコミット
git add src/components/ContactList.tsx
git commit -m "feat: Add search functionality to ContactList"

git add src/tests/ContactList.test.tsx  
git commit -m "test: Add tests for ContactList search"

# プレフィックスの使用
- feat: 新機能
- fix: バグ修正
- docs: ドキュメント
- style: スタイル変更
- refactor: リファクタリング
- test: テスト
- chore: その他
```

### 5.2 チーム開発での活用

#### ブランチ戦略
```bash
# 機能ブランチを作成
git checkout -b feature/search-function

# 作業
# ...

# プルリクエスト作成
gh pr create --title "検索機能追加" --body "..."
```

#### レビュー依頼
```
「以下のPRをレビューしてください：
https://github.com/[user]/[repo]/pull/[number]

特に以下の点を確認：
1. パフォーマンス
2. エラー処理
3. テストカバレッジ」
```

---

## 6. Claude Code 特有のベストプラクティス

### 6.1 コンテキスト管理

#### 長時間の作業セッション
```
「現在の作業状況をサマリーして、TODO.mdに保存してください」
（セッション終了前に状態を保存）
```

#### セッション再開時
```
「TODO.mdを読み込んで、前回の作業を継続してください」
```

### 6.2 効率的な指示

#### DO ✅
- 具体的な要件を提示
- 制約条件を明確に
- 期待する出力形式を指定
- 参考コードやパターンを提示

#### DON'T ❌
- 曖昧な指示
- 複数の大きなタスクを一度に
- コンテキストなしの修正依頼
- 「なんとなく」の要求

### 6.3 定期的なチェックポイント

```markdown
## 30分ごとのチェック
□ 現在の進捗は計画通りか
□ テストは通っているか
□ コミットは適切な単位か
□ 次のステップは明確か
```

---

## 7. プロジェクト完了時

### 7.1 ドキュメント整理
```
「プロジェクトのREADME.mdを作成してください。
含める内容：
- プロジェクト概要
- セットアップ手順
- 主要機能
- API仕様
- トラブルシューティング」
```

### 7.2 クリーンアップ
```
「以下のクリーンアップを実行してください：
1. 不要なconsole.logの削除
2. TODOコメントの確認
3. 未使用の依存関係削除
4. コードフォーマット統一」
```

---

## まとめ

### 成功の鍵 🔑

1. **計画を立てる** - IMPLEMENTATION_PLAN.mdで段階化
2. **小さく進める** - 大きな変更を避ける
3. **テストを書く** - 可能な限りTDD
4. **既存を尊重** - パターンとスタイルを踏襲
5. **記録を残す** - トラブルと解決策を文書化
6. **3回ルール** - 詰まったら停止して再考

### よくある失敗パターン 🚫

1. **計画なしの実装** → バグと手戻り
2. **大規模な一括変更** → レビュー困難
3. **テストの後回し** → 品質問題
4. **ドキュメント不足** → 保守困難
5. **エラーの無視** → 技術的負債

### 推奨ワークフロー 📊

```mermaid
graph LR
    A[要件定義] --> B[計画作成]
    B --> C[既存調査]
    C --> D[テスト作成]
    D --> E[実装]
    E --> F[リファクタリング]
    F --> G[レビュー]
    G --> H[コミット]
    H --> I[次のステージ]
```

このガイドラインに従うことで、Claude Codeを最大限活用し、高品質なコードを効率的に開発できます。